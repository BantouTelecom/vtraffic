
<div id="map_canvas" style="width: 100%; height: 100%">
	<p id='loading_map' class="label label-info span4 offset4 center">Loading...</p>	
</div>


<script type="text/javascript">

function initialize() {
	$('#loading_map').hide();
	
        var mapOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 8,
          mapTypeId: "OSM",
        };
	var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
	map.mapTypes.set("OSM", new google.maps.ImageMapType({
		getTileUrl: function(coord, zoom) {
		    return "http://tile.openstreetmap.org/" + zoom + "/" + coord.x + "/" + coord.y + ".png";
		},
		tileSize: new google.maps.Size(256, 256),
		name: "OpenMap",
		alt: "Open Street Maps",
		maxZoom: 18
	}));

        $("#map_canvas").css("width", '100%').css("height", 400);
	google.maps.event.trigger(map, 'resize');
}
function loadScript() {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src = "http://maps.googleapis.com/maps/api/js?key={{=response.google_map_key}}&sensor=false&callback=initialize";
	document.body.appendChild(script);
}
$('a[data-toggle="tab"]').on('shown', function(e) {
	$('#loading_map').show();
	loadScript();            
});

</script>

